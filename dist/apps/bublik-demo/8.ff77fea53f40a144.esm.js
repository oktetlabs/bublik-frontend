"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[8],{24008:(e,t,r)=>{r.r(t),r.d(t,{default:()=>je});r(75751),r(67859),r(30910),r(84002),r(81929);var a=r(52983),s=r(67182),n=r(95197),i=r(32642),l=r(35562),o=r(6563),d=r(69175),c=r(49806),u=(r(14209),r(12459),r(51811),r(78445)),m=r(2830),p=r(49171),h=r(25819),g=r(19587),v=r(39636),x=r(71977);const f=({onRefreshClick:e})=>{const t=(0,h._)();return(0,x.BX)(d.zx,{variant:"primary",onClick:()=>{e(),t.start({rotate:[0,360],transition:{duration:.4,stiffness:500,damping:10,type:"spring"}})},children:[(0,x.tZ)(g.E.div,{animate:t,children:(0,x.tZ)(v.P.InProgress24x24,{})}),"Refresh"]})},b=e=>{const{startDate:t,badges:r}=e;return(0,x.BX)("div",{className:"flex flex-col gap-2 p-2 bg-white rounded-lg shadow-popover",children:[(0,x.BX)("p",{className:"text-[0.875rem] leading-[1.125rem]",children:[(0,x.tZ)("span",{className:"text-[0.875rem] font-semibold",children:"Start Date:"}),(0,x.BX)("span",{children:[" ",t]})]}),(0,x.tZ)(d.k,{badges:r})]})},Z=e=>{const{badges:t,children:r,startDate:s}=e,n=(0,a.useMemo)((()=>t.map((e=>({payload:e})))),[t]);return(0,x.tZ)(d.am,{content:(0,x.tZ)(b,{startDate:s,badges:n}),animation:"shift-toward",placement:"bottom",children:r})};var y=r(73235),C=r(61661),N=r(2524),S=r(49516),P=r(99068),k=r(41874),D=r.n(k);const w=(0,a.memo)((({name:e,children:t})=>(0,x.tZ)("div",{className:"px-6 mb-1",children:(0,x.BX)("div",{className:"flex items-center justify-between",children:[(0,x.tZ)("div",{className:"flex items-center gap-2",children:(0,x.tZ)("span",{className:"text-[0.875rem] font-semibold",children:e})}),t]})})));var X=r(11095),B=r(67912);const R=["name","error","children"],_=(0,a.forwardRef)(((e,t)=>{let{name:r,error:a,children:s}=e,n=(0,X.Z)(e,R);return(0,x.BX)(B.xu,Object.assign({mb:4},n,{children:[(0,x.BX)(B.kC,{align:"center",justify:"space-between",ref:t,children:[(0,x.tZ)(B.xv,{fontSize:"xs",fontWeight:"semibold",lineHeight:"0.875rem",children:r}),(0,x.tZ)(B.kC,{align:"center",gap:2,children:s})]}),a&&(0,x.tZ)(B.xv,{fontSize:"xs",lineHeight:"0.875rem",color:"text.unexpected",children:a})]}))}));_.displayName="FormSectionHeader";const j=({name:e})=>(0,x.tZ)("div",{className:"mb-2",children:(0,x.tZ)("span",{className:"text-[0.6875rem] leading-[0.875rem]",children:e})}),L=({children:e})=>(0,x.BX)(d.xr,{className:"h-screen",children:[(0,x.tZ)(d.ap,{children:(0,x.tZ)("div",{className:"w-[768px]",children:e})}),(0,x.tZ)(d.gb,{orientation:"vertical",forceMount:!0,children:(0,x.tZ)(d.q4,{})}),(0,x.tZ)(d.gb,{orientation:"horizontal",children:(0,x.tZ)(d.q4,{})}),(0,x.tZ)(d.lj,{})]}),T=()=>(0,x.tZ)("div",{className:"sticky bottom-0 w-full px-6 py-4 mt-2 bg-white",children:(0,x.tZ)(d.zx,{variant:"primary",type:"submit",className:"w-full",children:"Submit"})}),E=(e,t)=>e===t,F=e=>"PASSED"===e,H=(e,t)=>e.every((e=>t.includes(e)));var O=r(31434);const I={verdict:i.T7.String,results:[i.Xm.Passed,i.Xm.Failed,i.Xm.Killed,i.Xm.Cored,i.Xm.Skipped,i.Xm.Faked,i.Xm.Incomplete],runProperties:[i.i4.NotCompromised],resultProperties:[i.Zu.Expected,i.Zu.Unexpected],startDate:(0,O.Z)(new Date,-93),endDate:new Date},M=["icon"],z=e=>{let{icon:t}=e,r=(0,X.Z)(e,M);const a=v.P[t];return(0,x.tZ)(B.M5,Object.assign({as:"button",type:"button",color:"bg.compromised",bgColor:"bg.body",_hover:{bgColor:"selected",color:"accent"},rounded:"base"},r,{children:(0,x.tZ)(a,{})}))};const A=(0,y.Z)("div",{target:"e13v3ufu1"})({display:"grid",columnGap:24,rowGap:16,gridTemplateColumns:"1fr 1fr 1fr 1fr",gridTemplateAreas:'\n  "date date . ."\n  "branch branch revision revision"\n  "tags tags tags tags"\n  "tags-expression tags-expression tags-expression tags-expression"'},""),V=(0,y.Z)("div",{target:"e13v3ufu0"})({name:"lqko5d",styles:"display:grid;grid-template-columns:repeat(4, minmax(0, 1fr));column-gap:1.5rem;row-gap:1rem"}),U=P.Ry().shape({testName:P.Z_().required("Test name is required!"),runProperties:P.IX().min(1,"Please specify is run compromised or not"),resultProperties:P.IX().min(1,"Please specify result type"),results:P.IX().min(1,"Please specify obtained results")}),W=({onSubmit:e,initialValues:t,onCloseButtonClick:r})=>{const s=(0,S.TA)({initialValues:t,onSubmit:e,validationSchema:U});(0,a.useEffect)((()=>{var e;const t=e=>{"Enter"===e.key&&e.ctrlKey&&s.submitForm()};return null==(e=document)||e.addEventListener("keydown",t),()=>{var e;return null==(e=document)?void 0:e.removeEventListener("keydown",t)}}),[s]);const{errors:n,touched:l}=s,o=n.resultProperties&&l.resultProperties?n.resultProperties:void 0,c=n.results&&l.results?n.results:void 0,u=n.runProperties&&l.runProperties?n.runProperties:void 0,m=o||c||void 0;return(0,x.tZ)(L,{children:(0,x.tZ)(B.kC,{direction:"column",gap:2,pt:7,children:(0,x.BX)(B.kC,{direction:"column",gap:4,bgColor:"bg.primary",children:[(0,x.tZ)(w,{name:"Global Search",children:(0,x.tZ)(z,{icon:"Cross12x12",onClick:r,"aria-label":"Close",bgColor:"transparent",_hover:{bgColor:"selected",color:"accent"},p:"5.5px"})}),(0,x.tZ)(S.Hy,{value:s,children:(0,x.BX)(S.l0,{onSubmit:s.handleSubmit,onKeyPress:e=>{"Enter"===e.key&&e.preventDefault()},children:[(0,x.BX)(B.kC,{direction:"column",gap:2,px:6,children:[(0,x.BX)("div",{children:[(0,x.tZ)(_,{name:"Test",children:(0,x.tZ)(z,{icon:"Bin22x22",onClick:()=>{s.resetForm({values:Object.assign({},s.values,{hash:"",parameters:[]})})}})}),(0,x.BX)(B.rj,{templateColumns:"repeat(2, minmax(0, 1fr))",columnGap:6,rowGap:4,children:[(0,x.tZ)(d.nv,{name:"testName",label:"Test name",type:"text",placeholder:"default_bufs"}),(0,x.tZ)(d.nv,{name:"hash",label:"Hash",type:"text",placeholder:"3c447d65a665c0eee17a0a20827e9"}),(0,x.tZ)(B.P4,{colSpan:2,children:(0,x.tZ)(d.Zz,{label:"Parameters",name:"parameters",placeholder:"time_limit:30"})})]})]}),(0,x.BX)("div",{children:[(0,x.tZ)(_,{name:"Run",error:u,children:(0,x.tZ)(z,{icon:"Bin22x22",onClick:()=>{s.resetForm({values:Object.assign({},s.values,{dates:{startDate:D()(I.startDate),endDate:D()(I.endDate)},revisions:[],runData:[],branches:[],runProperties:I.runProperties})})}})}),(0,x.BX)(A,{children:[(0,x.tZ)(B.P4,{w:"full",area:"date",children:(0,x.tZ)(d.B6,{name:"dates",label:"Date",ranges:{"One week":[D()((0,C.Z)(new Date,-1)),D()()],"Two weeks":[D()((0,C.Z)(new Date,-2)),D()()],"One month":[D()((0,N.Z)(new Date,-1)),D()()],"Three months":[D()((0,N.Z)(new Date,-3)),D()()],"Six months":[D()((0,N.Z)(new Date,-6)),D()()],"One year":[D()((0,N.Z)(new Date,-12)),D()()]}})}),(0,x.tZ)(B.P4,{area:"branch",children:(0,x.tZ)(d.Zz,{name:"branches",label:"Branch",placeholder:"master"})}),(0,x.tZ)(B.P4,{area:"revision",children:(0,x.tZ)(d.Zz,{name:"revisions",label:"Revisions",placeholder:"8af383125f20cc5ecdb8393bf"})}),(0,x.tZ)(B.P4,{w:"full",area:"tags",children:(0,x.tZ)(d.Zz,{label:"Tags",name:"runData",placeholder:"medford"})})]}),(0,x.BX)(V,{children:[(0,x.tZ)(d.ji,{iconName:"Compromised16x16",name:"runProperties",value:i.i4.Compromised,label:"Compromised"}),(0,x.tZ)(d.ji,{iconName:"NotCompromised16x16",name:"runProperties",value:i.i4.NotCompromised,label:"Not compromised"})]})]}),(0,x.BX)("div",{children:[(0,x.BX)(B.xu,{mb:4,children:[(0,x.tZ)(_,{name:"Result",error:m,style:{marginBottom:0},children:(0,x.tZ)(z,{icon:"Bin22x22",onClick:()=>{s.resetForm({values:Object.assign({},s.values,{results:I.results,resultProperties:I.resultProperties,verdict:[],verdictLookup:i.T7.String})})}})}),(0,x.tZ)(j,{name:"Result type classification"}),(0,x.BX)(V,{children:[(0,x.tZ)(d.ji,{iconName:"WarningDanger16x16",name:"resultProperties",value:i.Zu.Unexpected,label:"Unexpected"}),(0,x.tZ)(d.ji,{iconName:"WarningOk16x16",name:"resultProperties",value:i.Zu.Expected,label:"Expected"}),(0,x.tZ)(d.ji,{iconName:"WarningInfo16x16",name:"resultProperties",value:i.Zu.NotRun,label:"Not run"})]})]}),(0,x.BX)("div",{children:[(0,x.tZ)(j,{name:"Obtained result"}),(0,x.BX)(V,{children:[(0,x.tZ)(d.ji,{iconName:"Passed16x16",name:"results",value:i.Xm.Passed,label:"PASSED"}),(0,x.tZ)(d.ji,{iconName:"Failed16x16",name:"results",value:i.Xm.Failed,label:"FAILED"}),(0,x.tZ)(d.ji,{iconName:"Failed16x16",name:"results",value:i.Xm.Killed,label:"KILLED"}),(0,x.tZ)(d.ji,{iconName:"Failed16x16",name:"results",value:i.Xm.Cored,label:"CORED"}),(0,x.tZ)(d.ji,{iconName:"Skipped16x16",name:"results",value:i.Xm.Skipped,label:"SKIPPED"}),(0,x.tZ)(d.ji,{iconName:"Faked16x16",name:"results",value:i.Xm.Faked,label:"FAKED"}),(0,x.tZ)(d.ji,{iconName:"Failed16x16",name:"results",value:i.Xm.Incomplete,label:"INCOMPLETE"})]})]})]}),(0,x.BX)("div",{children:[(0,x.tZ)(_,{name:"Verdict"}),(0,x.BX)(V,{style:{marginBottom:24},children:[(0,x.tZ)(d.gu,{name:"verdictLookup",value:i.T7.String,label:"String"}),(0,x.tZ)(d.gu,{name:"verdictLookup",value:i.T7.Regex,label:"Regex"}),(0,x.tZ)(d.gu,{name:"verdictLookup",value:i.T7.None,label:"None"})]}),(0,x.tZ)(B.xu,{w:"full",children:(0,x.tZ)(d.Zz,{label:"String verdict",name:"verdict",placeholder:s.values.verdictLookup===i.T7.String?"Unexpectedly failed with errno ENOPROTOOPT":s.values.verdictLookup===i.T7.Regex?".\\*":"",disabled:s.values.verdictLookup===i.T7.None})})]})]}),(0,x.tZ)(T,{})]})})]})})})};var $=r(6264),G=r(37122),J=r(71428),K=r(13819);const q=e=>e.join(";"),Q=(e,t=[])=>e?e.split(";"):t,Y=e=>{const t=e.filter((e=>e.isExpression)).map((e=>e.value));return[e.filter((e=>!e.isExpression)).map((e=>e.value)),t]},ee=(e,t=[])=>e?e.split(";").map((e=>({id:(0,u.nanoid)(4),value:e,originalValue:e}))):t;var te=r(36162);const re=({count:e,label:t,resultType:r})=>(0,x.BX)("div",{className:"flex flex-col justify-between gap-1",children:[(0,x.BX)("div",{className:"flex items-center justify-start gap-2",children:[(0,x.tZ)("span",{className:"text-[0.875rem] font-semibold leading-[1.125rem]",children:e}),r?(0,x.tZ)("div",{className:(0,te.Z)("flex w-fit items-center rounded py-0.5 px-2","expected"===r?"bg-badge-3":"bg-badge-5"),children:(0,x.tZ)("span",{className:(0,te.Z)("text-[0.6875rem] leading-[0.875rem]","expected"===r?"text-text-expected":"text-text-unexpected"),children:"expected"===r?"Expected":"Unexpected"})}):null]}),(0,x.tZ)("span",{className:"text-[0.6875rem] leading-[0.875rem] text-text-menu",children:t})]}),ae=(0,a.memo)((e=>{const{runs:t=0,iterations:r=0,results:a=0,expected:s=0,unexpected:n=0}=e;return(0,x.BX)("div",{className:"flex flex-wrap gap-14",children:[(0,x.tZ)(re,{label:"Runs",count:t}),(0,x.tZ)(re,{label:"Iterations",count:r}),(0,x.tZ)(re,{label:"Test results",count:a}),(0,x.tZ)(re,{label:"Expected results",count:s,resultType:"expected"}),(0,x.tZ)(re,{label:"Unexpected results",count:n,resultType:"unexpected"})]})})),se=(0,a.memo)((e=>{const{onModeChange:t,mode:r}=e,s=(0,a.useCallback)((e=>t(e)),[t]),n="linear"===r,i="aggregation"===r;return(0,x.BX)("div",{className:"flex items-center justify-center border rounded-lg border-border-primary",children:[(0,x.tZ)(d.u,{content:"List of results",placement:"bottom",animation:"shift-toward",offset:[0,16],children:(0,x.tZ)("button",{className:(0,d.m6)("grid place-items-center pl-3 pr-1.5 text-border-primary w-full h-full hover:text-primary transition-colors",n&&"text-primary"),onClick:()=>s("linear"),children:(0,x.tZ)(v.P.HistoryLinear24x24,{})})}),(0,x.tZ)(d.u,{content:"Group iterations by verdicts",placement:"bottom",animation:"shift-toward",offset:[0,16],children:(0,x.tZ)("button",{className:(0,d.m6)("grid place-items-center text-border-primary px-1.5 w-full h-full hover:text-primary transition-colors",i&&"text-primary"),onClick:()=>s("aggregation"),children:(0,x.tZ)(v.P.HistoryAggregation24x24,{})})}),(0,x.tZ)(d.u,{content:"Comparison charts",placement:"bottom",animation:"shift-toward",offset:[0,16],children:(0,x.tZ)("button",{className:"grid place-items-center pr-3 pl-1.5 text-border-primary w-full h-full cursor-not-allowed",children:(0,x.tZ)(v.P.HistoryChart24x24,{})})})]})})),ne=e=>(0,x.tZ)(d.zx,Object.assign({variant:"header"},e,{children:(0,x.BX)("div",{className:"flex items-center gap-2",children:[(0,x.tZ)(v.P.GlobalSearch24x24,{className:"grid place-items-center"}),(0,x.tZ)("span",{className:"text-[0.875rem] leading-[1.5rem]",children:"Global Search"})]})})),ie=e=>{const{substringBadges:t,onSubstringChange:r}=e;return(0,x.tZ)("div",{className:"w-1/5",children:(0,x.tZ)(d.ef,{name:"substringFilter",placeholder:"Substring filter",onBadgesChange:r,badges:t,icon:(0,x.tZ)(v.P.MagnifyingGlass24x24,{className:"grid place-items-center text-primary"})})})},le=()=>{const{filteredParameters:e,filteredRunData:t,filteredObtained:r}=(0,c.xL)(c.j5),{filteredParams:s,filteredResults:i}=(0,c.xL)(c.S7),[d,h]=(0,o.XN)(),g=(0,n.TH)().state,[v,f]=(0,a.useState)(!1),b=()=>f(!1),Z=()=>f(!0),y=(0,a.useCallback)((e=>{b();const t=Object.assign({},(e=>{const{testName:t,hash:r,parameters:a,runData:s,dates:n,runProperties:i,resultProperties:l,results:o,verdictLookup:d,verdict:c,branches:u,revisions:m}=e,[p,h]=Y(a),[g,v]=Y(s),[x,f]=Y(u),[b,Z]=Y(m),[y,C]=Y(c),N=h.concat(v).concat(f).concat(Z).concat(C).join("&"),S=n.startDate?(0,G.Z)(n.startDate.toDate(),$.yJ):"",P=n.endDate?(0,G.Z)(n.endDate.toDate(),$.yJ):"";return(0,K.decamelizeKeys)({testName:t,hash:r,startDate:S,finishDate:P,parameters:q(p),runData:q(g),runDataExpr:N,branches:q(x),revisions:q(b),runProperties:q(i),resultProperties:q(l),results:q(o),verdict:q(y),verdictLookup:d},{separator:"_"})})(e),{page:"1",pageSize:d.pageSize});h(t)}),[h,d.pageSize]),C=(0,a.useMemo)((()=>{const a=(e=>{const{testName:t,hash:r,parameters:a,runData:s,startDate:n,finishDate:i,runProperties:l,resultProperties:o,results:d,verdictLookup:c,verdict:m,branches:p,revisions:h,runDataExpr:g}=e,v=Q(s).map((e=>({id:(0,u.nanoid)(4),value:e,originalValue:e}))),x=Q(g).map((e=>({id:(0,u.nanoid)(4),value:e,originalValue:e,isExpression:!0}))),f=n?D()((0,J.Z)(n,$.yJ,new Date)):D()(I.startDate),b=i?D()((0,J.Z)(i,$.yJ,new Date)):D()(new Date);return{testName:t||"",hash:r||"",parameters:ee(a,[]),revisions:ee(h,[]),branches:ee(p,[]),runData:[...x,...v],dates:{startDate:f,endDate:b},runProperties:Q(l,I.runProperties),resultProperties:Q(o,I.resultProperties),results:Q(d,I.results),verdictLookup:c||I.verdict,verdict:ee(m,[])}})(d),n=a.runData.map((e=>e.value)).concat(t),l=a.verdict.map((e=>e.value)).concat(r).concat(i),o=a.parameters.map((e=>e.value)).concat(e).concat(s),c=Array.from(new Set(o)).filter((t=>{const r=e.includes(t),a=s.includes(t);return r&&a})),m=Array.from(new Set(n)).filter((e=>t.includes(e))),p=Array.from(new Set(l)).filter((e=>{const t=r.includes(e),a=i.includes(e);return t&&a}));a.parameters=c.map((e=>({id:(0,u.nanoid)(4),value:e,originalValue:e})));const h=m.map((e=>({id:(0,u.nanoid)(4),value:e,originalValue:e}))),g=a.runData.filter((e=>e.isExpression));return a.runData=[...g,...h],a.verdict=p.map((e=>({id:(0,u.nanoid)(4),value:e,originalValue:e}))),a}),[r,e,s,i,t,d]),N=(null==g?void 0:g.fromRun)||!(null!=d&&d.testName)||(null==d?void 0:d.fromRun);return(0,a.useEffect)((()=>{N&&Z()}),[N]),(0,l.Kr)("Escape",(()=>{v&&b()}),[v]),(0,x.BX)(x.HY,{children:[(0,x.tZ)(ne,{onClick:Z}),(0,x.tZ)(m.u,{appear:!0,show:v,as:a.Fragment,children:(0,x.BX)(p.V,{as:"div",className:"relative z-50",open:v,onClose:()=>f(!1),children:[(0,x.tZ)(m.u.Child,{as:a.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,x.tZ)("div",{className:"fixed inset-0 z-40 bg-black bg-opacity-5"})}),(0,x.tZ)(m.u.Child,{as:a.Fragment,enter:"ease-out duration-300",enterFrom:"right-[-100%]",enterTo:"right-0",leave:"ease-in duration-200",leaveFrom:"right-0",leaveTo:"right-[-100%]",children:(0,x.tZ)(p.V.Panel,{className:"fixed top-0 z-50 h-screen bg-white",children:(0,x.tZ)(W,{initialValues:C,onSubmit:y,onCloseButtonClick:b})})})]})})]})},oe=({label:e,value:t,iconName:r})=>{const a=v.P[r];return(0,x.BX)("div",{className:"flex items-center justify-center gap-2 px-2.5 py-1.5 rounded border border-border-primary",children:[(0,x.BX)("div",{className:"flex items-center gap-1.5 flex-shrink-0 text-text-menu ",children:[(0,x.tZ)(a,{className:"grid place-items-center text-text-menu"}),(0,x.BX)("span",{className:"text-[0.75rem] font-semibold leading-[0.875rem] text-text-secondary",children:[e,":"]})]}),(0,x.tZ)("div",{className:"flex flex-wrap items-center gap-3",children:t?Array.isArray(t)?t.map((e=>(0,x.tZ)(d.Ct,{className:"bg-primary-wash text-[0.6875rem] leading-[0.875rem] text-text-secondary",children:e},e))):(0,x.tZ)(d.Ct,{className:"bg-primary-wash text-[0.6875rem] leading-[0.875rem] text-text-secondary",children:t}):(0,x.tZ)(d.Ct,{className:"bg-primary-wash text-[0.6875rem] leading-[0.875rem] text-text-secondary",children:"\u2014"})})]})};oe.displayName="LegendItem";const de=(0,a.memo)((({items:e})=>(0,x.tZ)("div",{className:"flex flex-wrap items-center gap-4",children:e.map((({label:e,iconName:t,value:r})=>(0,x.tZ)(oe,{label:e,iconName:t,value:r},e)))})));de.displayName="HistoryLegend";const ce=e=>e.split(";"),ue=()=>{const[e]=(0,o.XN)(),t=(0,a.useMemo)((()=>{const{testName:t,date:r,hash:a,results:s,branches:n,revisions:i,expression:l,runProperties:o,resultProperties:d,verdictLookup:c,verdict:u}=(e=>{var t,r;const a=null!=(t=e.testName)?t:null,s=e.startDate&&e.finishDate?`${e.startDate} \u2014 ${e.finishDate}`:null,n=null!=(r=e.hash)?r:null,i=e.branches?ce(e.branches):null,l=e.revisions?ce(e.revisions):null,o=e.runDataExpr,d=e.runProperties?ce(e.runProperties):null,c=e.resultProperties?ce(e.resultProperties):null;return{testName:a,date:s,hash:n,results:e.results?ce(e.results):null,branches:i,revisions:l,expression:o,resultProperties:c,runProperties:d,verdictLookup:e.verdictLookup,verdict:e.verdict?ce(e.verdict):null}})(e);return[{iconName:"Document24x24",label:"Test name",value:t},{iconName:"Calendar24x24",label:"Date",value:r},{iconName:"Hash24x24",label:"Hash",value:a},{iconName:"ObtainedResult24x24",label:"Obtained result",value:s},{iconName:"DocumentSecondary24x24",label:"Branches",value:n},{iconName:"DocumentSecondary24x24",label:"Revisions",value:i},{iconName:"DocumentSecondary24x24",label:"Tags expressions",value:l},{iconName:"DocumentSecondary24x24",label:"Run",value:o},{iconName:"DocumentSecondary24x24",label:"Result type classification",value:d},{iconName:"DocumentSecondary24x24",label:"Verdict mode",value:c},{iconName:"DocumentSecondary24x24",label:"Verdict value",value:u}]}),[e]);return(0,x.tZ)(de,{items:t})};var me=r(56403);const pe=()=>{const[e]=(0,o.XN)(),{data:t}=me.Ul.endpoints.getHistoryLinear.useQueryState(e,{selectFromResult:({data:e})=>({data:null==e?void 0:e.counts})}),{data:r}=me.Ul.endpoints.getHistoryAggregation.useQueryState(e,{selectFromResult:({data:e})=>({data:null==e?void 0:e.counts})}),s=(0,a.useMemo)((()=>e.mode&&"linear"!==e.mode||!t?"aggregation"===e.mode&&r?r:{expected_results:0,iterations:0,runs:0,total_results:0,unexpected_results:0}:t),[r,t,e.mode]);return(0,x.tZ)(ae,{runs:s.runs,iterations:s.iterations,results:s.total_results,expected:s.expected_results,unexpected:s.unexpected_results})};r(90142),r(40697),r(94641),r(12213),r(3107),r(75044);var he=r(45502),ge=r(91151);const ve=e=>{const t=(0,s.I0)(),[r,n]=(0,a.useState)(e);(0,a.useEffect)((()=>{n(e)}),[e]);return{filters:r,updateFilters:(e,a,s)=>{if(r[a].includes(e)){const i=Object.assign({},r,{[a]:r[a].filter((t=>t!==e))});n(i),t("linear"===s?(0,c.EM)(i):(0,c.iN)(i))}else{const i=Object.assign({},r,{[a]:[...r[a],e]});n(i),t("linear"===s?(0,c.EM)(i):(0,c.iN)(i))}},checkIfFilterHasValue:(e,t)=>r[t].includes(e)}},xe={headerRow:{borderBottomLeftRadius:"6px",borderBottomRightRadius:"6px",height:"40px"},header:{position:"sticky",top:0},bodyRow:{padding:"12px 0",border:"1px solid transparent",backgroundColor:"var(--chakra-colors-bg-primary)",transition:"all 0.2s ease","&:hover":{border:"1px solid",borderColor:"var(--chakra-colors-accent)"}}},fe=()=>{(0,l.jr)("History - Aggregation - Bublik");const e=(0,c.xL)(c.S7),t=(0,c.xL)(c.B0),r=(0,c.xL)(c.uC),s=(0,c.xL)(c.rF),[n,u]=(0,o.XN)(),{data:m,isFetching:p,isError:h,error:g}=(0,me.k4)(n),{filters:{filteredParams:v,filteredResults:f,filteredHash:b},updateFilters:y,checkIfFilterHasValue:C}=ve(e),N=(0,a.useMemo)((()=>m?m.results.filter((e=>{const t=e.parameters,a=e.results_by_verdicts.reduce(((e,t)=>[...e,...t.verdict]),[]),s=[e.hash],n=v.every((e=>t.includes(e))),l=f.every((e=>a.includes(e))),o=f.map((e=>new RegExp(e))).every((e=>a.every((t=>t&&t.match(e))))),d=b.every((e=>s.includes(e)));switch(r){case i.T7.String:return d&&n&&l;case i.T7.Regex:return d&&n&&o;case i.T7.None:default:return!0}})):[]),[m,b,v,f,r]),S=(0,a.useCallback)(((e,t,r)=>e.filter((e=>!r.length||r.some((t=>{const r=e.original.hash.includes(t),a=e.original.parameters.some((e=>e.includes(t))),s=e.original.results_by_verdicts.reduce(((e,t)=>[...e,...t.verdict]),[]).some((e=>null==e?void 0:e.includes(t)));return a||s||r}))))),[]),P=(0,a.useMemo)((()=>[{Header:"Parameters / Hash",accessor:({parameters:e,hash:t})=>({parameters:e,hash:t}),Cell:({value:e})=>{const{parameters:t,hash:r}=e,a=t.find((e=>e.startsWith("env=")));return(0,x.BX)(B.kC,{direction:"column",gap:1,children:[(0,x.tZ)("div",{children:a&&(0,x.tZ)(d.lA,{value:a.split("=")[1],isSelected:C(a,"filteredParams"),onContentClick:()=>y(a,"filteredParams","aggregation")})}),(0,x.tZ)(B.kC,{flexWrap:"wrap",gap:1,children:t.filter((e=>!e.startsWith("env="))).map((e=>(0,x.tZ)("div",{style:{cursor:"pointer"},children:(0,x.tZ)(d.Ct,{className:"bg-badge-1",isSelected:C(e,"filteredParams"),onClick:()=>y(e,"filteredParams","aggregation"),children:e})},e)))}),(0,x.tZ)(B.xu,{w:"min-content",py:.5,px:1.5,rounded:"base",bgColor:"selected",cursor:"pointer",border:"1px solid",borderColor:C(r,"filteredHash")?"accent":"transparent",onClick:()=>y(r,"filteredHash","aggregation"),children:r})]})},columnCSS:{paddingLeft:"24px"},maxWidth:400,disableSortBy:!0},{Header:"Results / Logs",accessor:e=>e.results_by_verdicts,Cell:({value:e})=>(0,x.tZ)(B.kC,{direction:"column",gap:1,children:e.map(((e,t)=>{const r=e.has_error?(0,x.tZ)(d.Ct,{variant:"unexpected",children:"FAILED"}):(0,x.tZ)(d.Ct,{variant:"expected",children:"PASSED"});return(0,x.BX)(a.Fragment,{children:[(0,x.tZ)(B.kC,{children:r}),e.verdict.map((e=>(0,x.tZ)("div",{style:{cursor:"pointer"},children:(0,x.tZ)(d.Ct,{variant:"transparent",isSelected:C(e,"filteredResults"),onClick:()=>y(e,"filteredResults","aggregation"),children:e})},e))),(0,x.tZ)(B.kC,{wrap:"wrap",gap:1,children:e.results_data.map(((e,t)=>(0,x.tZ)(Z,{badges:e.relevant_tags,startDate:e.start_date,children:(0,x.tZ)(he.rU,{to:o._j.log({runId:e.run_id,focusId:e.result_id}),state:{fromHistory:!0},children:(0,x.tZ)(d.Ct,{variant:"primary",children:t+1})})},e.result_id)))})]},e.key)}))}),sortType:(e,t)=>{const r=e.original.results_by_verdicts;return Object.values(r).some((e=>e.has_error))?1:-1},columnCSS:{paddingRight:"24px",paddingLeft:"100px"}}]),[C,y]),k=(0,a.useMemo)((()=>(0,x.tZ)(d.$j,{className:"h-[75vh]"})),[]),D=(0,a.useMemo)((()=>{const e=null==g?void 0:g.status;return(0,x.tZ)(d.rJ,{header:`${e}`||"Something went wrong",message:(0,ge.e$)(e)})}),[g]);return p||null!=m&&m.results.length?(0,x.BX)("main",{children:[(0,x.tZ)(B.xu,{mb:2,children:(0,x.tZ)(d.iA,{columns:P,data:N,isFetching:p,isError:h,errorComponent:D,spinner:k,emotionBaseTableCSS:xe,globalFilter:S,globalFilterValue:t,autoResetSortBy:!1,headerShadow:!0})}),(0,x.tZ)(B.M5,{children:m&&(0,x.tZ)(d.tl,{currentPage:n.page?parseInt(n.page):1,totalCount:m.pagination.count,pageSize:s,onPageSizeChange:e=>{u({pageSize:e})},siblingCount:1,onPageChange:e=>{u({page:e.toString()})}})})]}):(0,x.tZ)(d.rJ,{header:"No results found",message:"Looks like no results found."})};var be=r(56712);const Ze="MMM dd yyyy, HH:mm:ss.SSS",ye=(e,t)=>{const r=e.original.start_date,a=t.original.start_date;if((0,ge.Rp)(r,Ze)&&(0,ge.Rp)(a,Ze)){const e=(0,J.Z)(r,Ze,new Date),t=(0,J.Z)(a,Ze,new Date);return e.getTime()>t.getTime()?1:-1}return console.error("Something wrong with start date, parsing failed"),1},Ce=(e,t)=>{const r=e.original.expected_result.result_type;return F(r)?1:-1},Ne=e=>{const{resultId:t,runId:r,important:a,tags:s,expectedResult:n,obtainedResult:l,parameters:d,hasMeasurements:c}=e,[u]=(0,o.XN)(),m=[...a,...s].join(";"),p=d.join(";"),h=F(l.result_type)?i.Xm.Passed:i.Xm.Failed,g=l.verdict.join(";"),v=E(n.result_type,l.result_type)?i.Zu.Expected:i.Zu.Unexpected,f={testName:u.testName,mode:u.mode,runData:m,parameters:p,results:h,verdict:g,runProperties:u.runProperties,resultProperties:v,hash:u.hash,startDate:u.startDate,finishDate:u.finishDate,pageSize:u.pageSize,verdictLookup:i.T7.String,page:"1"},b=(0,o.X6)(f);return(0,x.BX)("div",{className:"flex flex-col gap-1",children:[(0,x.tZ)(B.rU,{variant:B.CT.Primary,iconLeft:"EscapeRight20x20",justifyContent:"flex-start",width:"fit-content",to:o._j.log({runId:r,focusId:t,mode:"infoAndlog"}),children:"Log"}),(0,x.tZ)(B.rU,{variant:B.CT.Primary,iconLeft:"EscapeRight20x20",justifyContent:"flex-start",width:"fit-content",to:`/runs/${r}`,children:"Run"}),(0,x.tZ)(B.rU,{variant:B.CT.Primary,iconLeft:"EscapeRight20x20",justifyContent:"flex-start",width:"fit-content",to:`/history${b}`,children:"History"}),c&&(0,x.tZ)(B.rU,{variant:B.CT.Primary,iconLeft:"EscapeRight20x20",justifyContent:"flex-start",width:"fit-content",to:`/runs/${r}/results/${t}/measurements`,children:"Measure"})]})},Se=({dateTime:e,duration:t})=>{const[r,a]=e.split(",");return(0,x.BX)("div",{className:"flex flex-col gap-1",children:[(0,x.tZ)("span",{className:"font-semibold",children:r}),(0,x.tZ)("span",{children:`${a}, [${t}]`})]})},Pe=({metadata:e,selectedMeta:t,onMetaClick:r})=>(0,x.tZ)(d.k,{badges:e,selectedBadges:t,onBadgeClick:r,className:"bg-badge-4"}),ke={headerRow:{borderBottomLeftRadius:"6px",borderBottomRightRadius:"6px",height:"40px",padding:"0 16px"},header:{position:"sticky",top:0,zIndex:1},bodyRow:{padding:"12px 16px",border:"1px solid transparent",backgroundColor:"var(--chakra-colors-bg-primary)",transition:"all 0.2s ease","&:hover":{border:"1px solid",borderColor:"var(--chakra-colors-accent)"}}},De=()=>{(0,l.jr)("History - Linear - Bublik");const e=(0,s.I0)(),[t,r]=(0,o.XN)(),u=(0,c.xL)(c.j5),m=(0,c.xL)(c.rF),p=(0,c.xL)(c.VH),h=(0,c.xL)(c.uC),g=(0,c.xL)(c.fk),f=(0,c.xL)(c.B0),{filters:b,checkIfFilterHasValue:Z,updateFilters:y}=ve(u),C=(0,n.TH)().state,{data:N,isFetching:S,isError:P,error:k}=(0,me.m6)(null!=C&&C.fromRun||null!=t&&t.fromRun?be.skipToken:t),D=(0,a.useMemo)((()=>{if(N){return N.results.filter((e=>{const t=e.important_tags,r=e.relevant_tags,a=e.metadata,s=e.obtained_result.verdict,n=e.expected_result.result_type,l=e.obtained_result.result_type,o=e.parameters,d=[...t,...r,...a],c=H(b.filteredRunData,d),u=H(b.filteredObtained,s),m=b.filteredObtained.map((e=>new RegExp(e))).every((e=>s.every((t=>t.match(e))))),v=H(b.filteredParameters,o),x=E(n,l)?i.Zu.Expected:i.Zu.Unexpected,f=F(l)?i.Xm.Passed:i.Xm.Failed,Z=!p||!g||x===p&&f===g;switch(h){case i.T7.String:return c&&u&&v&&Z;case i.T7.Regex:return c&&m&&v&&Z;case i.T7.None:default:return!0}}))}return[]}),[g,p,N,b.filteredObtained,b.filteredParameters,b.filteredRunData,h]),w=(0,a.useCallback)(((t,r)=>{p===t&&g===r?(e((0,c.HV)(null)),e((0,c.oG)(null))):(e((0,c.HV)(t)),e((0,c.oG)(r)))}),[g,p,e]),X=(0,a.useCallback)(((e,t,r)=>e.filter((e=>r.length?r.some((t=>{const r=e.original,a=r.start_date.includes(t),s=r.important_tags.some((e=>e.includes(t))),n=r.metadata.some((e=>e.includes(t))),i=r.relevant_tags.some((e=>e.includes(t))),l=r.expected_result.verdict.some((e=>e.includes(t))),o=r.obtained_result.verdict.some((e=>e.includes(t))),d=Object.entries(r.parameters).map((([e,t])=>`${e}:${t}`)).some((e=>e.includes(t)));return a||s||n||i||l||o||d})):e))),[]),B=(0,a.useMemo)((()=>[{Header:"Actions",id:"links expander",accessor:e=>({runId:e.run_id,iterationId:e.iteration_id,resultId:e.result_id,important:e.important_tags,tags:e.relevant_tags,obtainedResult:e.obtained_result,expectedResult:e.expected_result,parameters:e.parameters,hasMeasurements:e.has_measurements}),Cell:({value:e})=>(0,x.tZ)(Ne,Object.assign({},e)),maxWidth:90,minWidth:60,disableSortBy:!0},{Header:()=>(0,x.BX)("div",{className:"flex items-center gap-1",children:[(0,x.tZ)(d.u,{content:"Timezone: UTC",children:(0,x.tZ)(v.P.InfoCircleQuestionMark16x16,{className:"flex items-center justify-center text-primary"})}),(0,x.tZ)("span",{children:"Start [Duration]"})]}),id:"start-duration",accessor:e=>e.start_date,Cell:e=>(0,x.tZ)(Se,{dateTime:e.value,duration:e.row.original.duration}),sortType:ye,maxWidth:205,minWidth:180,width:200,columnCSS:{paddingLeft:"32px",paddingRight:"8px"}},{Header:"Metadata",accessor:e=>e.metadata.map((e=>({payload:e}))),Cell:e=>(0,x.tZ)(Pe,{metadata:e.value,selectedMeta:b.filteredRunData,onMetaClick:e=>y(e.payload,"filteredRunData","linear")}),maxWidth:180,disableSortBy:!0,columnCSS:{paddingRight:"8px"}},{Header:"Tags",accessor:e=>{const t=e.relevant_tags.map((e=>({payload:e})));return[...e.important_tags.map((e=>({payload:e,isImportant:!0}))),...t]},Cell:e=>(0,x.tZ)(d.k,{badges:e.value,selectedBadges:b.filteredRunData,onBadgeClick:e=>y(e.payload,"filteredRunData","linear")}),columnCSS:{paddingRight:"8px"},disableSortBy:!0},{Header:"Expected Results",accessor:e=>e.expected_result,Cell:e=>{const t=e.value.result_type,r=e.value.verdict;return(0,x.tZ)(d.pH,{variant:"expected",result:t,verdicts:r})},sortType:Ce,maxWidth:280,sortDescFirst:!0,sortInverted:!0,columnCSS:{paddingRight:"8px"}},{Header:"Obtained Results",accessor:e=>({obtained:e.obtained_result,expected:e.expected_result,isNotExpected:e.has_error}),Cell:e=>{const t=e.value.expected.result_type,r=e.value.obtained.result_type,a=E(t,r),s=F(r),n=a?i.Zu.Expected:i.Zu.Unexpected,l=s?i.Xm.Passed:i.Xm.Failed,o=p===n&&g===l;return(0,x.tZ)(d.pH,{variant:"obtained",result:e.value.obtained.result_type,isResultSelected:o,verdicts:e.value.obtained.verdict,selectedVerdicts:b.filteredObtained,onResultClick:e=>w(n,l),onVerdictClick:e=>y(e,"filteredObtained","linear"),isNotExpected:e.value.isNotExpected})},sortType:Ce,maxWidth:280,sortDescFirst:!0,sortInverted:!0,columnCSS:{paddingRight:"8px"}},{Header:"Parameters",accessor:e=>e.parameters,Cell:e=>{const t=e.value.filter((e=>!e.startsWith("env="))),r=e.value.find((e=>e.startsWith("env=")));return(0,x.BX)("div",{className:"flex flex-col items-start gap-1",children:[r&&(0,x.tZ)(d.lA,{value:r.split("=")[1],isSelected:Z(r,"filteredParameters"),onContentClick:()=>y(r,"filteredParameters","linear")}),(0,x.tZ)("div",{className:"flex flex-wrap gap-1",children:t.map((e=>(0,x.tZ)(d.Ct,{className:"bg-badge-1",isSelected:Z(e,"filteredParameters"),onClick:()=>y(e,"filteredParameters","linear"),children:e},e)))})]})},disableSortBy:!0}]),[b.filteredRunData,b.filteredObtained,y,p,g,w,Z]),R=(0,a.useMemo)((()=>(0,x.tZ)(d.$j,{className:"h-[75vh]"})),[]),_=(0,a.useMemo)((()=>{const e=null==k?void 0:k.status;return(0,x.tZ)(d.rJ,{header:`${e}`||"Something went wrong",message:(0,ge.e$)(e)})}),[k]);return S||null!=N&&N.results.length?(0,x.BX)("main",{children:[(0,x.tZ)("div",{className:"mb-2",children:(0,x.tZ)(d.iA,{columns:B,data:D,isFetching:S,isError:P,errorComponent:_,spinner:R,emotionBaseTableCSS:ke,globalFilter:X,globalFilterValue:f,autoResetSortBy:!1,headerShadow:!0})}),(0,x.tZ)("div",{className:"flex items-center justify-center",children:N&&(0,x.tZ)(d.tl,{currentPage:t.page?parseInt(t.page):1,totalCount:N.pagination.count,pageSize:m,onPageSizeChange:e=>{r(Object.assign({},t,{pageSize:e}))},siblingCount:1,onPageChange:e=>{r(Object.assign({},t,{page:e.toString()}))}})})]}):(0,x.tZ)(d.rJ,{header:"No results found",message:"Looks like no results found."})};var we=r(16559);const Xe=()=>{const e=(0,c.xL)(c.d5),[,t]=(0,o.XN)(),r=(0,a.useCallback)((e=>t((t=>(0,we.ZP)(t,(t=>{t.page="1",t.mode=e}))))),[t]);return(0,x.tZ)(se,{mode:e,onModeChange:r})},Be=()=>{const e=(0,s.I0)(),t=(0,c.xL)(c.d5),r=(0,c.xL)(c.j5),n=(0,c.xL)(c.S7),i=(0,c.xL)(c.VH),l=(0,c.xL)(c.fk),[d,u]=(0,o.XN)(),m=(0,a.useCallback)((()=>{if(e(me.Ul.util.invalidateTags([me.o_.HistoryData])),"linear"===t){const e=Array.from(new Set([...r.filteredRunData])).join(";"),t=Array.from(new Set(r.filteredObtained)).join(";"),a=Array.from(new Set(r.filteredParameters)).join(";"),s=i||(null==d?void 0:d.resultProperties)||$.zu.join(";");u(Object.assign({},d,{resultProperties:s,results:l||(d.results?d.results:$.CH.join(";")),runData:e,verdict:t,parameters:a,page:"1"}))}if("aggregation"===t){const e=Array.from(new Set(n.filteredParams)).join(";"),t=Array.from(new Set(n.filteredResults)).join(";"),r=Array.from(new Set(n.filteredHash));u(Object.assign({},d,{verdict:t,parameters:e,hash:r[0],page:"1"}))}}),[e,r.filteredObtained,r.filteredParameters,r.filteredRunData,n.filteredHash,n.filteredParams,n.filteredResults,l,i,t,d,u]);return(0,x.tZ)(f,{onRefreshClick:m})},Re=()=>{const e=(0,s.I0)(),t=(0,c.xL)(c.B0),r=(0,a.useCallback)((t=>{e((0,c.V$)(t.map((e=>e.value))))}),[e]),n=(0,a.useMemo)((()=>t.map((e=>({id:(0,u.nanoid)(4),value:e,originalValue:e})))),[t]);return(0,x.tZ)(ie,{substringBadges:n,onSubstringChange:r})},_e=()=>(0,x.BX)("header",{className:"flex flex-col gap-4 px-6 py-4 mb-1 bg-white rounded-t-xl",children:[(0,x.BX)("div",{className:"flex flex-wrap justify-between gap-4",children:[(0,x.tZ)(Re,{}),(0,x.BX)("div",{className:"flex gap-4",children:[(0,x.tZ)(le,{}),(0,x.tZ)(Be,{}),(0,x.tZ)(Xe,{})]})]}),(0,x.tZ)(pe,{}),(0,x.tZ)(ue,{})]}),je=()=>{(0,l.jr)("History - Bublik");const e=(0,s.I0)(),t=(0,c.xL)(c.d5),[r]=(0,o.XN)(),u=(0,n.TH)();return(0,a.useEffect)((()=>{if(e((0,c.NP)()),r.mode&&e((0,c.aP)(r.mode)),r.verdict||r.parameters||r.runData||r.hash){var t,a,s;const n=r.hash?[r.hash]:[],i=(null==(t=r.verdict)?void 0:t.split(";").filter((e=>e)))||[],l=(null==(a=r.parameters)?void 0:a.split(";").filter((e=>e)))||[],o=(null==(s=r.runData)?void 0:s.split(";").filter((e=>e)))||[];e((0,c.EM)({filteredRunData:o,filteredObtained:i,filteredParameters:l})),e((0,c.iN)({filteredParams:l,filteredResults:i,filteredHash:n}))}if(r.results===i.Xm.Passed||r.results===i.Xm.Failed){const t=r.results===i.Xm.Passed?i.Xm.Passed:i.Xm.Failed;e((0,c.oG)(t))}r.pageSize&&e((0,c.vN)(r.pageSize)),r.verdictLookup&&e((0,c.vF)(r.verdictLookup))}),[e,u,r]),u.search&&"?mode=aggregation"!==u.search&&"?mode=linear"!==u.search?(0,x.BX)("div",{className:"flex flex-col p-2",children:[(0,x.tZ)(_e,{}),"linear"===t&&(0,x.tZ)(De,{}),"aggregation"===t&&(0,x.tZ)(fe,{}),(0,x.tZ)(d.uv,{offset:191})]}):(0,x.BX)("div",{className:"flex flex-col p-2",children:[(0,x.tZ)(_e,{}),(0,x.tZ)(d.rJ,{header:"Please fill out global search form",message:"Test name not found"}),(0,x.tZ)(d.uv,{offset:158})]})}}}]);